define(["mtemplate!app/pages/listpage/listpage.html","mtemplate!app/pages/listpage/pagenavbar.html","basecontroller"],function(e,t,n){n.extend("Page.ListPage",{},{template:e,getData:function(){return{issues:Model.Issue.findAll()}},preRender:function(e){e.attr("statusMap",new can.Map({todo:e.issues.withStatus("todo"),inprogress:e.issues.withStatus("inprogress"),done:e.issues.withStatus("done")}))},renderNavbar:function(e){e.html(t(this.options)),this.on(e.find("a#create-new"),"click",function(e){e.stop(),App.openPopup(Page.EditIssuePage,{})})},".item-link click":function(e,t){t.stop(),App.openPage(Page.IssuePage,{issue:e.model()})},"{Model.Issue} statuschange":function(e,t,n){var r=this.options.statusMap;if(n.from){var i=r.attr(n.from);i.remove(n.issue)}if(n.to){var s=r.attr(n.to);s.push(n.issue)}}})});