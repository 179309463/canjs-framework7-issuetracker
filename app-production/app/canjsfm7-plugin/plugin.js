define(["framework7","jquery","mtemplate!canjsfm7-plugin/pagebase.mustache","mtemplate!canjsfm7-plugin/pagenavbar.mustache","mtemplate!canjsfm7-plugin/popupnavbar.mustache"],function(e,t,n,r,i){Framework7.prototype.plugins.canjsPlugin=function(e,s){var o={},u={};return e.openPage=function(r,i){var s={animatePages:!0,showBackLink:!0};i=can.extend(s,i),r.pageConfig=i,r.url="",i.content=n.render(),i.element=t('<div class="page-content"></div>');var o=new i.pageController(i.element,i.options);return o._preRenderPhase().done(function(){e.loadPage(r,i)})},u.pageBeforeInit=function(e){var n=t(e.container),i=e.view.pageConfig;n.append(i.element);var s=n.find(".page-content").control(),o=t(e.navbarInnerContainer);s.navbar=o;if(s.renderNavbar)s.renderNavbar(o);else{var u={showBackLink:i.showBackLink};can.extend(u,s.navbarOptions);var a=i.navbarTemplate||r;o.html(a(u))}s._postRenderPhase(),e.view.pageConfig=null},u.pageBeforeRemove=function(e){var n=t(e.container).find(".page-content"),r=n.control();r.destroy()},e.openPopup=function(t,n){var r=this,s={animatePages:!1,showBackLink:!1,navbarTemplate:i};n=can.extend(s,n),e.openPage(t,n).done(function(){r.popup(".popup")})},t(".popup").on("closed",function(){t(".popup .navbar").html(""),t(".popup .pages").html("")}),{hooks:u}}});